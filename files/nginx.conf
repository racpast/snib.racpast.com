worker_processes 2;

events {
	worker_connections 1024;
}

http {
	log_format custom_log 'Time: [$time_local] | Request Method: "$request_method" | Request URI: "$scheme://$http_host$request_uri" | Status Code: $status | Response Time: $upstream_response_time seconds';
	access_log logs/access.log custom_log;
	error_log logs/error.log notice;
	proxy_set_header Host $http_host;
	proxy_ssl_server_name on;
	proxy_buffer_size 128k;
	proxy_buffers 4 256k;
	proxy_busy_buffers_size 256k;
	fastcgi_buffers 16 128k;
	keepalive_timeout 120;
	keepalive_requests 10000;
	server_names_hash_max_size 512;
	server_names_hash_bucket_size 1024;
	proxy_connect_timeout 10s;
	proxy_next_upstream error timeout http_502 http_503 http_504;
	proxy_next_upstream_tries 0;
	proxy_next_upstream_timeout 120s;
	proxy_send_timeout 300s;
	proxy_read_timeout 300s;

	map $http_upgrade $connection_upgrade {
        default upgrade;
        '' close;
    }

	#	Pixiv Start
	upstream pixiv-net {
		server 210.140.139.152:443;
		server 210.140.139.155:443;
		server 210.140.139.158:443;
		server 210.140.139.161:443;
	}

	upstream i-pximg-net {
		server 210.140.139.135:443;
		server 210.140.139.132:443;
		server 210.140.139.137:443;
		server 210.140.139.134:443;
		server 210.140.139.131:443;
		server 210.140.139.130:443;
		server 210.140.139.129:443;
		server 210.140.139.136:443;
	}

	upstream pixiv-pximg-net {
		server 210.140.139.135:443;
		server 210.140.139.132:443;
		server 210.140.139.137:443;
		server 210.140.139.134:443;
		server 210.140.139.131:443;
		server 210.140.139.133:443;
		server 210.140.139.130:443;
		server 210.140.139.129:443;
		server 210.140.139.136:443;
	}

	upstream a-pixiv-org {
		server 210.140.139.183:443;
		server 210.140.139.184:443;
		server 210.140.139.182:443;
	}

	upstream d-pixiv-org {
		server 210.140.139.183:443;
		server 210.140.139.184:443;
		server 210.140.139.182:443;
	}

	upstream api-fanbox-cc {
		server 104.18.41.140:443;
		server 172.64.146.116:443;
	}

	upstream lc-event-pixiv-net {
		server 210.140.139.185:443;
	}

	server {
		listen 443 ssl;
		
		server_name pixiv.net;
		server_name *.pixiv.net;
		server_name fanbox.cc;
		server_name *.fanbox.cc;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		
		proxy_ssl_name  pixivision.net;
		client_max_body_size 50M;

		location / {
			proxy_pass https://pixiv-net;
		}
	}

	server {
		listen 443 ssl;
		
		server_name lc-event.pixiv.net;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		
		proxy_ssl_name pixivision.net;

		location / {
			proxy_pass https://lc-event-pixiv-net;
		}
	}

	server {
		listen 443 ssl;
		
		server_name *.pximg.net;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name pixivision.net;

		location / {
			proxy_pass https://i-pximg-net;
		}
	}

	server {
		listen 443 ssl;
		
		server_name pixiv.pximg.net;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://pixiv-pximg-net;
		}
	}

	server {
		listen 443 ssl;
		
		server_name a.pixiv.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://a-pixiv-org;
		}
	}

	server {
		listen 443 ssl;
		
		server_name d.pixiv.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://d-pixiv-org;
		}
	}

	server {
		listen 443 ssl;
		
		server_name api.fanbox.cc;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		client_max_body_size 50M;

		location / {
			proxy_pass https://api-fanbox-cc;
		}
	}
	#	Pixiv End

	#	Nyaa Start
	upstream sukebei-nyaa-si {
		server 198.251.89.38:443;
	}

	upstream nyaa-si {
		server 186.2.163.20:443;
	}

	server {
		listen 443 ssl;
		
		server_name sukebei.nyaa.si;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://sukebei-nyaa-si/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name nyaa.si;
		server_name *.nyaa.si;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://nyaa-si/;
		}
	}
	#	Nyaa End


	#	Pornhub Start
	upstream pornhub-com {
		server 66.254.114.40:443;
	}

	upstream cdn-jsdelivr-net {
		server 151.101.65.229:443;
		server 151.101.1.229:443;
		server 151.101.129.229:443;
		server 151.101.201.229:443;
		server 104.18.186.31:443;
		server 146.75.77.229:443;
		server 104.18.187.31:443;
		server 146.75.125.229:443;
		server 146.75.81.229:443;
		server 151.101.41.229:443;
		server 151.101.193.229:443;
		server 146.75.37.229:443;
	}

	upstream www-gstatic-com {
		server 8.137.102.117:443;
	}

	server {
		listen 443 ssl;
		
		server_name pornhub.com;
		server_name *.pornhub.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://pornhub-com/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name gstatic.com;
		server_name *.gstatic.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		
		proxy_ssl_name g.cn;

		location / {
			proxy_pass https://www-gstatic-com/;		
		}
	}

	server {
		listen 443 ssl;
		
		server_name cdn.jsdelivr.net;
		server_name *.jsdelivr.net;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://cdn-jsdelivr-net/;
		}
	}
	#	Pornhub End

	#	Wikimedia Foundation Start
	upstream wikipedia-org {
		server 198.35.26.96:443;
		server 208.80.154.224:443;
		server 208.80.153.224:443;
		server 103.102.166.224:443;
		server 185.15.59.224:443;
		server 185.15.58.224:443;
	}

	upstream upload-wikipedia-org {
		server 208.80.153.240:443;
		server 208.80.154.240:443;
		server 198.35.26.112:443;
		server 185.15.59.240:443;
	}

	server {
		listen 443 ssl;
		
		server_name wikipedia.org;
		server_name *.wikipedia.org;
		server_name *.m.wikipedia.org;
		
		server_name wikimedia.org;
		server_name *.wikimedia.org;
		server_name *.m.wikimedia.org;
		
		server_name wikivoyage.org;
		server_name *.wikivoyage.org;
		server_name *.m.wikivoyage.org;	
		
		server_name wiktionary.org;
		server_name *.wiktionary.org;
		server_name *.m.wiktionary.org;
		
		server_name wikibooks.org;
		server_name *.wikibooks.org;
		server_name *.m.wikibooks.org;
		
		server_name wikinews.org;
		server_name *.wikinews.org;
		server_name *.m.wikinews.org;
		
		server_name wikidata.org;
		server_name *.wikidata.org;
		server_name *.m.wikidata.org
		
		server_name wikiversity.org;
		server_name *.wikiversity.org;
		server_name *.m.wikiversity.org;
		
		server_name wikiquote.org;
		server_name *.wikiquote.org;
		server_name *.m.wikiquote.org;
		
		server_name mediawiki.org;
		server_name *.mediawiki.org;
		server_name *.m.mediawiki.org;
		
		server_name wikisource.org;
		server_name	*.wikisource.org;
		server_name	*.m.wikisource.org;
		
		server_name wikifunctions.org;
		server_name *.wikifunctions.org;
		server_name *.m.wikifunctions.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://wikipedia-org/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name upload.wikimedia.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://upload-wikipedia-org/;
		}
	}
	#	Wikimedia Foundation End

	#	Archive of Our Own Start
	upstream archiveofourown-org {
		server 104.20.9.2:443;
		server 104.20.8.2:443;
	}

	server {
		listen 443 ssl;
		
		server_name archiveofourown.org;
		server_name *.archiveofourown.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://archiveofourown-org/;
		}
	}
	#	Archive of Our Own End

	#	WallHaven Start (image CDN Only, excluding pages)
	upstream wallhaven-cc {
		server 15.235.80.145:443;
	}

	server {
		listen 443 ssl http2;

		server_name wallhaven.cc;
		server_name *.wallhaven.cc;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://wallhaven-cc/;
		}
	}
	#	WallHaven End

	#	Steam Community Start
	upstream steamcommunity-com {
		server 23.8.65.235:443;
		server 23.210.138.105:443;
		server 23.51.204.111:443;
		server 184.30.90.143:443;
		server 184.84.187.165:443;
		server 23.76.43.59:443;
		server 23.64.7.151:443;
		server 23.194.234.100:443;
		server 23.66.133.162:443;
	}

	server {
		listen 443 ssl;
		
		server_name steamcommunity.com;
		server_name *.steamcommunity.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://steamcommunity-com/;
		}
	}
	#	Steam Community End

	#	E-Hentai Start
	upstream e-hentai-org {
		server 172.66.132.196:443;
		server 172.66.140.62:443;
	}

	upstream exhentai-org {
		server 178.175.132.22:443 max_fails=0;
		server 178.175.129.254:443 max_fails=0;
		server 178.175.128.254:443 max_fails=0;
	}

	upstream forums-e-hentai-org {
		server 172.66.140.62:443;
		server 172.66.132.196:443;
	}

	upstream api-e-hentai-org {
		server 5.79.104.110:443;
		server 212.7.200.104:443;
		server 37.48.92.161:443;
		server 212.7.202.51:443;
		server 37.48.81.204:443;
	}

	upstream upload-e-hentai-org {
		server 95.211.208.236:443;
		server 89.149.221.236:443;
	}

	upstream ehgt-org {
		server 89.39.106.43:443;
		server 62.112.8.21:443;
		server 109.236.85.28:443;
	}

	# upstream hentaiverse-org {
		# server 5.79.76.142:443;
		# server 178.162.151.56:443;
	# }

	# upstream ehwiki-org {
		# server 178.162.151.58:443;
	# }

	# upstream ehtracker-org {
		# server 37.48.81.218:443;
		# server 5.79.104.115:443;
		# server 212.7.202.58:443;
		# server 212.7.200.122:443;
		# server 37.48.92.183:443;
	# }

	server {
		listen 443 ssl;
		
		server_name e-hentai.org;
		server_name *.e-hentai.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://e-hentai-org/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name exhentai.org;
		server_name *.exhentai.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://exhentai-org/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name forums.e-hentai.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://forums-e-hentai-org/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name api.e-hentai.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://api-e-hentai-org/;
		}
	}

	server {
		listen 443 ssl;

		server_name upld.e-hentai.org;
		server_name upload.e-hentai.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://upload-e-hentai-org/;
			client_max_body_size 400M;
			fastcgi_connect_timeout 3000;
			fastcgi_send_timeout 3000;
			fastcgi_read_timeout 3000;
		}
	}

	server {
		listen 443 ssl;
		
		server_name ehgt.org;
		server_name *.ehgt.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://ehgt-org/;
		}
	}

	# server {
		# listen 443 ssl;
		
		# server_name hentaiverse.org;
		# server_name *.hentaiverse.org;
		
		# ssl_certificate ca/SNIBypassCrt.crt;
		# ssl_certificate_key ca/SNIBypassKey.key;

		# location / {
			# proxy_pass https://hentaiverse-org/;
		# }
	# }

	# server {
		# listen 443 ssl;
		
		# server_name ehwiki.org;
		# server_name *.ehwiki.org;
		
		# ssl_certificate ca/SNIBypassCrt.crt;
		# ssl_certificate_key ca/SNIBypassKey.key;

		# location / {
			# proxy_pass https://ehwiki-org/;
		# }
	# }

	# server {
		# listen 443 ssl;
		
		# server_name ehtracker.org;
		# server_name *.ehtracker.org;
		
		# ssl_certificate ca/SNIBypassCrt.crt;
		# ssl_certificate_key ca/SNIBypassKey.key;

		# location / {
			# proxy_pass https://ehtracker-org/;
		# }
	# }
	#	E-Hentai End

	#	OKX.COM Start
	upstream okx-com {
		server 8.212.101.92:443;
	}

	server {
		listen 443 ssl;
		
		server_name okx.com;
		server_name *.okx.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://okx-com/;
		}
	}
	#	OKX.COM End

	#	Google LLC Start
	upstream gemini-google-com {
		server 47.102.115.14:443;
	}

	server {
		listen 443 ssl;
		
		server_name gemini.google.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name g.cn;

		location / {
			proxy_pass https://gemini-google-com/;		
		}
	}
	
	upstream google-com {
		server 34.49.133.3:443;
	}

	server {
		listen 443 ssl;
		
		server_name ~^.*(google|goog).*$;
		server_name gmail.com;
		server_name *.gmail.com;
		server_name android.com;
		server_name *.android.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name g.cn;

		location / {
			proxy_pass https://google-com/;		
		}
	}
	#	Google LLC End

	#	Youtube Start
	upstream youtube-com {
		server 8.137.102.117:443;
	}

	server {
		listen 443 ssl;
		
		server_name youtube.com;
		server_name *.youtube.com;
		server_name *.gdata.youtube.com;
		server_name upload.youtube.com;
		server_name *.upload.youtube.com;
		server_name uploads.stage.gdata.youtube.com;
		server_name usercontent.youtube.com;
		server_name *.usercontent.youtube.com;
		server_name *.youtube-nocookie.com;
		server_name youtu.be;
		server_name *.youtu.be;
		server_name ytimg.com;
		server_name *.ytimg.com;
		server_name ggpht.com;
		server_name *.ggpht.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name g.cn;

		location / {
			proxy_pass https://youtube-com/;		
		}
	}

	server {
		listen 443 ssl;

		server_name googlevideo.com;
		server_name *.googlevideo.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		
		proxy_ssl_name g.cn;
		
		resolver 223.5.5.5 ipv4=off;

		location / {
			if ($http_host ~* ^(.+).googlevideo.com$) {
				proxy_pass https://$1.gvt1.com;
			}
		}
	}
	#	Youtube End

	#	F-Droid Start
	upstream f-droid-org {
		server 37.218.243.72:443;
	}

	upstream forum-f-droid-org {
		server 37.218.242.53:443;
	}

	server {
		listen 443 ssl;
		
		server_name f-droid.org;
		server_name *.f-droid.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://f-droid-org/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name forum.f-droid.org;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://forum-f-droid-org/;
		}
	}
	#	F-Droid End

	#	APKMirror Start
	upstream apkmirror-com {
		server 104.17.67.215:443;
		server 104.17.65.215:443;
		server 104.17.68.215:443;
		server 104.17.69.215:443;
		server 104.17.66.215:443;
	}

	server {
		listen 443 ssl;
		
		server_name apkmirror.com;
		server_name *.apkmirror.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://apkmirror-com/;
		}
	}
	#	APKirror End

	#	Amazon.co.jp Start
	upstream amazon-co-jp {
		server 18.66.145.15:443;
	}

	server {
		listen 443 ssl;
		
		server_name amazon.co.jp;
		server_name *.amazon.co.jp;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name amazon.com;
		
		location / {
			proxy_pass https://amazon-co-jp/;			
		}
	}
	#	Amazon.co.jp End

	#	The New York Times Start
	upstream www-nytimes-com {
		server 146.75.117.164:443;
	}

	server {
		listen 443 ssl;
		
		server_name nytimes.com;
		server_name *.nytimes.com;
		server_name *.nyt.com;
		server_name *.et.nytimes.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://www-nytimes-com/;
		}
	}
	#	The New York Times End

	#	BBC Start
	upstream bbc-com {
		server 146.75.36.81:443;
	}

	upstream bbci-co-uk {
		server 23.77.21.232:443;
	}

	server {
		listen 443 ssl;
		
		server_name bbc.com;
		server_name *.bbc.com;
		server_name *.api.bbc.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
			
		location / {
			proxy_pass https://bbc-com/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name bbci.co.uk;
		server_name *.bbci.co.uk;
		server_name static.bbci.co.uk;
		server_name *.files.bbci.co.uk;	
		server_name *.api.bbci.co.uk;
		server_name bbc.co.uk;
		server_name *.api.bbc.co.uk;
		server_name *.bbc.co.uk;
		server_name *.live.bbc.co.uk;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://bbci-co-uk/;
		}
	}
	#	BBC End

	#	Etsy Start
	upstream etsy-com {
		server 151.101.193.224:443;
	}

	server {
		listen 443 ssl;
		
		server_name etsy.com;
		server_name *.etsy.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
			
		location / {
			proxy_pass https://etsy-com/;
		}
	}
	#	Etsy End

	#	OK Start
	upstream ok-ru {
		server 5.61.23.11:443;
	}

	server {
		listen 443 ssl;
		
		server_name ok.ru;
		server_name *.ok.ru;
		server_name *.ms.ok.ru;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://ok-ru/;
		}
	}
	#	OK End

	#	Z-Library Start
	upstream 1lib-sk {
		server 176.123.7.105:443;
	}

	server {
		listen 443 ssl;
		
		server_name z-lib.help;
		server_name *.z-lib.help;
		server_name z-library.sk;
		server_name *.z-library.sk;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://1lib-sk/;
		}
	}
	#	Z-Library End

	#	Proton Start
	upstream proton-me {
		server 185.70.42.45:443;
	}

	server {
		listen 443 ssl;
		
		server_name proton.me;
		server_name *.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://proton-me/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name account.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.36:443/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name account-api.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.20:443/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name mail.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.37:443/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name calendar.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.39:443/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name drive.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.40:443/;
		}
	}

	server {
		listen 443 ssl;
		
		server_name pass.proton.me;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://185.70.42.63:443/;
		}
	}
	#	Proton End

	#	Gelbooru Start
	upstream gelbooru-com {
		server 108.181.143.72:443;
	}

	server {
		listen 443 ssl;
		
		server_name gelbooru.com;
		server_name *.gelbooru.com;
		
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://gelbooru-com/;
		}
	}
	#	Gelbooru End

	#	Github Start
	upstream github-com {
		server 20.205.243.166:443;
		server 20.27.177.113:443;
		server 20.200.245.247:443;
	}
	upstream codeload-github-com {
		server 20.205.243.165:443;
		server 20.27.177.114:443;
		server 20.200.245.246:443;
	}
	upstream api-github-com {
		server 20.205.243.168:443;
		server 20.27.177.116:443;
		server 20.200.245.245:443;
	}
	upstream redirect-github-com {
		server 140.82.112.17:443;
		server 140.82.113.17:443;
		server 140.82.114.17:443;
		server 140.82.112.18:443;
		server 140.82.113.18:443;
		server 140.82.114.18:443;
	}
	upstream edu-github-com {
		server 140.82.112.21:443;
		server 140.82.112.22:443;
		server 140.82.113.21:443;
		server 140.82.113.22:443;
		server 140.82.114.21:443;
		server 140.82.114.22:443;
	}

	upstream githubusercontent-com {
		server 185.199.109.133:443;
		server 185.199.108.133:443;
		server 185.199.110.133:443;
		server 185.199.111.133:443;
		server 167.82.0.133:443;
		server 167.82.20.133:443;
		server 167.82.84.133:443;
		server 167.82.88.133:443;
		server 146.75.112.133:443;
		server 146.75.20.133:443;
		server 151.101.64.133:443;
		server 151.101.76.133:443;
		server 151.101.128.133:443;
		server 151.101.192.133:443;
		server 199.232.208.133:443;
		server 199.232.212.133:443;
		server 199.232.232.133:443;
		server [2a04:4e42:75::133]:443;
		server [2a04:4e42:76::133]:443;
		server [2a04:4e42:82::133]:443;
		server [2a04:4e42:8c::133]:443;
		server [2a04:4e42:4d::133]:443;
		server [2a04:4e42:4c::133]:443;
		server [2a04:4e42:12::133]:443;
		server [2a04:4e42:15::133]:443;
		server [2a04:4e42:1a::133]:443;
		server [2a04:4e42:36::133]:443;
		server [2a04:4e42:48::133]:443;
	}

	upstream githubassets-com {
		server 185.199.109.154:443;
		server 185.199.108.154:443;
		server 185.199.110.154:443;
		server 185.199.111.154:443;
		server [2606:50c0:8000::154]:443;
		server [2606:50c0:8001::154]:443;
		server [2606:50c0:8002::154]:443;
		server [2606:50c0:8003::154]:443;
	}

	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name github.com;
		server_name www.github.com;
		server_name gist.github.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://github-com/;
		}
	}

	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name codeload.github.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://codeload-github-com/;
			proxy_set_header Host $http_host;
			proxy_headers_hash_max_size 8192;
			proxy_buffer_size 128k;
			proxy_buffers 4 256k;
			proxy_busy_buffers_size 256k;
		}
	}

	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name api.github.com lfs.github.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://api-github-com/;
			proxy_set_header Host $http_host;
			proxy_headers_hash_max_size 8192;
			proxy_buffer_size 128k;
			proxy_buffers 4 256k;
			proxy_busy_buffers_size 256k;
		}
	}

	# server {
		# listen 443 ssl http2;
		# listen [::]:443 ssl http2;

		# server_name objects-origin.githubusercontent.com;

		# ssl_certificate ca/SNIBypassCrt.crt;
		# ssl_certificate_key ca/SNIBypassKey.key;

		# location / {
			# proxy_pass https://edu-github-com/;
			# proxy_set_header Host $http_host;
			# proxy_set_header Range $http_range;
			# proxy_set_header If-Range $http_if_range;

			# if ($request_method = 'OPTIONS') {
				# add_header Access-Control-Allow-Origin $http_origin;
				# add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
				# add_header Access-Control-Allow-Headers 'Content-Type, Authorization, Content-Length, X-Requested-With';
				# add_header Access-Control-Allow-Credentials true;
				# return 204;
			# }

			# if ($http_origin = "https://github.com") {
				# add_header Access-Control-Allow-Origin "https://github.com";
			# }

			# add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
			# add_header Access-Control-Allow-Headers 'Content-Type, Authorization, Content-Length, X-Requested-With';
			# add_header Access-Control-Allow-Credentials true;
		# }
	# }
	
	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name redirect.github.com copilot.github.com services.github.com community.github.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://redirect-github-com/;
			proxy_set_header Host $http_host;
			proxy_headers_hash_max_size 8192;
			proxy_buffer_size 128k;
			proxy_buffers 4 256k;
			proxy_busy_buffers_size 256k;
		}
	}

	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name education.github.com enterprise.github.com classroom.github.com central.github.com collector.github.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://edu-github-com/;
			proxy_set_header Host $http_host;
			proxy_headers_hash_max_size 8192;
			proxy_buffer_size 128k;
			proxy_buffers 4 256k;
			proxy_busy_buffers_size 256k;
		}
	}

	server {
		listen 80;
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name githubusercontent.com analytics.githubassets.com lab.github.com assets-cdn.github.com www.github.io pages.github.com resources.github.com developer.github.com partner.github.com desktop.github.com guides.github.com support.github.com git-lfs.github.com;
		server_name *.githubusercontent.com *.github.io;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://githubusercontent-com/;
			proxy_set_header Host $http_host;
			proxy_set_header Range $http_range;
			proxy_set_header If-Range $http_if_range;
		}
	}

	server {
		listen 80;
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
		
		server_name docs.github.com;
		server_name githubassets.com;
		server_name *.githubassets.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://githubassets-com/;
			proxy_set_header Host $http_host;
			proxy_set_header Range $http_range;
			proxy_set_header If-Range $http_if_range;
		}
	}
	#	Github End

	#	DuckDuckGo Start
	upstream duckduckgo-com {
		server 20.43.161.105:443;
		server 20.204.244.192:443;
		server 40.114.177.156:443;
		server 52.250.42.157:443;
		server 40.89.244.232:443;
	}

	upstream external-content-duckduckgo-com {
		server 52.250.30.213:443;
		server 40.89.244.234:443;
		server 52.149.246.247:443;
		server 52.142.125.222:443;
		server 40.114.178.124:443;
	}

	server { 
		listen 80;
		listen 443 ssl http2;

		server_name  external-content.duckduckgo.com$;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location  / { 
			proxy_pass  https://external-content-duckduckgo-com;
		}
	}

	server {
		listen 80;
		listen 443 ssl http2;

		server_name duckduckgo.com;
		server_name *.duckduckgo.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://duckduckgo-com/;
		}
	}
	#	DuckDuckGo End
	
	#	GreasyFork Start
	upstream greasyfork-org {
		server 96.126.98.220:443;
		server 50.116.4.196:443;
		server [2600:3c01::f03c:95ff:fe58:20d3]:443;
		server [2600:3c01::f03c:95ff:fee3:1156]:443;
	}
	
	server {
		listen 443 ssl http2;
		listen [::]:443 ssl http2;
			
		server_name greasyfork.org;
		server_name *.greasyfork.org;
			
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
			
		location / {
			proxy_pass https://greasyfork-org/;
			proxy_headers_hash_max_size 8192;
			proxy_buffer_size 128k;
			proxy_buffers 4 256k;
			proxy_busy_buffers_size 256k;
		}
	}
	#	GreasyFork End
	
	#	Facebook Start
	server {
		listen 443 ssl;

		server_name facebook.com;
		server_name *.facebook.com;
		server_name fbcdn.net;
		server_name *.fbcdn.net;
		server_name business.whatsapp.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://157.240.22.169;
		}
	}
	#	Facebook End

	#	Instagram Start
	server {
		listen 443 ssl;

		server_name instagram.com;
		server_name *.instagram.com;
		server_name instagr.am;
		server_name *.instagr.am;
		server_name ig.me;
		server_name *.ig.me;
		server_name static.cdninstagram.com;
		server_name *.cdninstagram.com;
	
		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://157.240.236.174;
		}
	}
	#	Instagram End

	#	X Start
	server {
		listen 443 ssl;

		server_name twitter.com;
		server_name *.twitter.com;
		server_name x.com;
		server_name *.x.com;
		server_name t.co;
		server_name *.t.co;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://69.195.183.139;
		}
	}

	server {
		listen 443 ssl;

		server_name twimg.com;
		server_name *.twimg.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://146.75.72.157;
		}
	}
	#	X End

	#	WhatsApp Start
	server {
		listen 443 ssl;

		server_name whatsapp.com;
		server_name *.whatsapp.com;
		server_name whatsapp.net;
		server_name *.whatsapp.net;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://157.240.225.60;
		}
	}
	#	WhatsApp End

	#	Prismic Images Start
	upstream images-prismic-io {
		server 151.101.78.208:443;
		server 151.101.130.208:443;
		server 151.101.66.208:443;
		server 151.101.194.208:443;
		server 151.101.2.208:443;
	}

	server {
		listen 443 ssl;

		server_name images.prismic.io;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://images-prismic-io;
		}
	}
	#	Prismic Images End

	#	Pinterest Start
	server {
		listen 443 ssl;

		server_name pinterest.com;
		server_name *.pinterest.com;
		server_name pinimg.com;
		server_name *.pinimg.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://151.101.0.84;
		}
	}
	#	Pinterest End

	#	Rutube Start
	server {
		listen 443 ssl;

		server_name rutube.ru;
		server_name *.rutube.ru;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://109.238.90.239;
		}
	}
	#	Rutube End

	#	Hugging Face Start
	server {
		listen 443 ssl;

		server_name huggingface.co;
		server_name discuss.huggingface.co;
		server_name status.huggingface.co;
		server_name cdn-avatars.huggingface.co;
		server_name cdn-uploads.huggingface.co;
		server_name *.huggingface.co;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://3.167.200.113;
		}
	}
	#	Hugging Face End

	#	Rumble Start
	server {
		listen 443 ssl;

		server_name rumble.com;
		server_name *.rumble.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://205.220.231.24;
		}
	}
	#	Rumble End

	#	Reddit Start
	server {
		listen 443 ssl;

		server_name reddit.com;
		server_name *.reddit.com;
		server_name redditstatic.com;
		server_name *.redditstatic.com;
		server_name redd.it;
		server_name *.redd.it;
		server_name redditmedia.com;
		server_name *.redditmedia.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://146.75.33.140;
		}
	}
	#	Reddit End

	#	Twitch Start
	server {
		listen 443 ssl;

		server_name assets.twitch.tv;
		server_name panels.twitch.tv;
		server_name passport.twitch.tv;
		server_name irc-ws.chat.twitch.tv;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://3.167.200.113;
		}
	}

	server {
		listen 443 ssl;

		server_name twitch.tv;
		server_name *.twitch.tv;
		server_name m.twitch.tv;
		server_name gql.twitch.tv;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://151.101.194.167;
		}
	}
	#	Twitch End

	#	Steam Store Start
	server {
		listen 443 ssl;

		server_name store.steampowered.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://23.46.197.62;
		}
	}
	#	Steam Store End

	#	Telegram Start
	upstream pluto-web-telegram-org {
		server [2001:b28:f23d:8007::805:531]:443;
		server [2001:b28:f23d:8007::805:532]:443;
	}
	
	upstream kws1-kws3-kw5-web-telegram-org {
		server 149.154.174.100:443;
	}
	
	upstream kws2-kw4-venus-vesta-web-telegram-org {
		server [2001:67c:4e8:f004::9]:443;
	}
	
	upstream flora-1-web-telegram-org {
		server 149.154.171.236:443;
		server 149.154.170.96:443;
		server 149.154.171.237:443;
	}

	server {
		listen 443 ssl;

		server_name pluto.web.telegram.org;
		server_name pluto-1.web.telegram.org;
		server_name aurora.web.telegram.org;
		server_name aurora-1.web.telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://pluto-web-telegram-org;
		}
	}
	
	server {
		listen 443 ssl;

		server_name kws1.web.telegram.org;
		server_name kws1-1.web.telegram.org;
		server_name kws3.web.telegram.org;
		server_name kws3-1.web.telegram.org;
		server_name kws5.web.telegram.org;
		server_name kws5-1.web.telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://pluto-web-telegram-org;
		}
	}
	
	server {
		listen 443 ssl;

		server_name kws2.web.telegram.org;
		server_name kws2-1.web.telegram.org;
		server_name kws4.web.telegram.org;
		server_name kws4-1.web.telegram.org;
		server_name venus.web.telegram.org;
		server_name venus-1.web.telegram.org;
		server_name vesta.web.telegram.org;
		server_name vesta-1.web.telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://kws2-kw4-venus-vesta-web-telegram-org;
		}
	}
	
	server {
		listen 443 ssl;

		server_name flora-1.web.telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://flora-1-web-telegram-org;
		}
	}
	
	server {
		listen 443 ssl;
		
		server_name server_name ~^zws[24].*\.web\.telegram\.org$;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://136.244.94.246;
		}
	}
	
	server {
		listen 443 ssl;
		
		server_name server_name ~^zws[13].*\.web\.telegram\.org$;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://149.154.174.200;
		}
	}
	
	server {
		listen 443 ssl;
		
		server_name flora.web.telegram.org;
		server_name *.web.telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://149.154.170.200;
		}
	}

	server {
		listen 443 ssl;

		server_name telegram.org;
		server_name *.telegram.org;
		server_name telegram.me;
		server_name *.telegram.me;
		server_name tg.dev;
		server_name *.tg.dev;
		server_name t.me;
		server_name *.t.me;
		server_name telesco.pe;
		server_name *.telesco.pe;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / { 
			proxy_pass https://136.244.94.246;
		}
	}
	server {
		listen 443 ssl;

		server_name cdn1.cdn-telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://34.111.15.3;
		}
	}

	server {
		listen 443 ssl;

		server_name cdn4.cdn-telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://34.111.35.152;
		}
	}

	server {
		listen 443 ssl;

		server_name cdn5.cdn-telegram.org;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://34.111.108.175;
		}
	}
	#	Telegram End

	#	V2EX Start
	upstream v2ex-com {
		server 172.66.137.6:443;
		server 172.66.133.207:443;
	}
	
	server {
		listen 443 ssl;

		server_name v2ex.com;
		server_name *.v2ex.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://v2ex-com;
		}
	}
	#	V2EX End

	#	OneDrive Live Start
	server {
		listen 443 ssl;

		server_name onedrive.live.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://13.107.42.13;
		}
	}
	#	OneDrive Live End

	#	MEGA Start
	server {
		listen 443 ssl;

		server_name mega.io;
		server_name *.mega.io;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://66.203.127.11;
		}
	}

	server {
		listen 443 ssl;

		server_name mega.nz;
		server_name *.mega.nz;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://31.216.144.5;
		}
	}

	server {
		listen 443 ssl;

		server_name api.mega.co.nz;
		server_name *.api.mega.co.nz;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://66.203.125.15;
		}
	}
	#	MEGA End

	#	Dropbox Start
	# 定义子域到 IP 的映射
	map $host $backend_ip {
		www.dropbox.com				162.125.80.18;
		bolt.dropbox.com			162.125.40.1;
		d.dropbox.com				162.125.6.20;
		previews.dropbox.com		162.125.83.16;
		beacon.dropbox.com			162.125.40.1;
		thunder.dropbox.com			162.125.40.1;
		fp.dropbox.com				18.154.206.82;
		assets.dropbox.com			216.137.39.27;
		default						162.125.248.18;
	}

	# 处理 dropbox.com 及其子域
	server {
		listen 443 ssl;
		server_name dropbox.com;
		server_name *.dropbox.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		proxy_ssl_verify off;

		client_max_body_size 50M;

		# 设置全局 CORS 头部，避免重复
		set $cors_origin $http_origin;

		location / {
			if ($request_method = OPTIONS) {
				add_header 'Access-Control-Allow-Origin' $cors_origin;
				add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS, PUT, DELETE';
				add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization';
				add_header 'Access-Control-Allow-Credentials' 'true';
				add_header 'Access-Control-Max-Age' 1728000;
				add_header 'Content-Type' 'text/plain; charset=utf-8';
				add_header 'Content-Length' 0;
				return 204;
			}

			proxy_pass https://$backend_ip;
			proxy_set_header Host $host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Cookie $http_cookie;

			proxy_hide_header 'Access-Control-Allow-Origin';
			add_header 'Access-Control-Allow-Origin' $cors_origin;
			add_header 'Access-Control-Allow-Credentials' 'true';

			proxy_hide_header 'Content-Security-Policy';
			add_header 'Content-Security-Policy' "script-src 'unsafe-eval' 'inline-speculation-rules' https://www.dropbox.com/static/api/ https://www.dropbox.com/pithos/ https://cfl.dropboxstatic.com/static/ https://www.dropboxstatic.com/static/ https://accounts.google.com/gsi/client https://canny.io/sdk.js https://www.paypal.com/sdk/js https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/ 'unsafe-inline' blob:;";
		}

		# 处理 WebSocket 请求
		location ~ ^/(2/notify/subscribe|2/payloads/subscribe|1/update) {
			proxy_pass https://$backend_ip;
			proxy_http_version 1.1;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection "upgrade";
			proxy_set_header Host $host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Cookie $http_cookie;

			# 避免重复添加 CORS 头部
			proxy_hide_header 'Access-Control-Allow-Origin';
			add_header 'Access-Control-Allow-Origin' $cors_origin;
			add_header 'Access-Control-Allow-Credentials' 'true';
		}
	}

	upstream dl-dropboxusercontent-com {
		server 162.125.1.15:443;
		server 162.125.2.15:443;
		server 162.125.13.15:443;
		server 162.125.8.15:443;
		server 162.125.69.15:443;
		server 162.125.64.15:443;
		server 162.125.68.15:443;
		server 162.125.71.15:443;
		server 162.125.72.15:443;
		server 162.125.65.15:443;
		server 162.125.81.15:443;
		server 162.125.80.15:443;
		server 162.125.85.15:443;
	}

	# 处理 dl.dropboxusercontent.com 和 previews.dropboxusercontent.com
	server {
		listen 443 ssl;
		server_name dl.dropboxusercontent.com;
		server_name *.dl.dropboxusercontent.com;
		server_name previews.dropboxusercontent.com;
		server_name *.previews.dropboxusercontent.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
		
		proxy_ssl_verify off;

		client_max_body_size 50M;

		set $cors_origin $http_origin;

		location / {
			if ($request_method = OPTIONS) {
				add_header 'Access-Control-Allow-Origin' $cors_origin;
				add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
				add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
				add_header 'Access-Control-Allow-Credentials' 'true';
				add_header 'Access-Control-Max-Age' 1728000;
				add_header 'Content-Type' 'text/plain; charset=utf-8';
				add_header 'Content-Length' 0;
				return 204;
			}

			proxy_pass https://dl-dropboxusercontent-com;
			proxy_set_header Host $host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Cookie $http_cookie;

			proxy_hide_header 'Access-Control-Allow-Origin';
			add_header 'Access-Control-Allow-Origin' $cors_origin;
			add_header 'Access-Control-Allow-Credentials' 'true';
		}
	}
	#	Dropbox End

	#	RFI Start
	server {
		listen 443 ssl;

		server_name rfi.fr;
		server_name *.rfi.fr;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://118.214.247.61;
			# 在 Nginx 中启用 HTTP/2 时必须通过 ALPN 协商，例如：
			# listen 443 ssl http2;
			# 某些客户端（例如 IP 为 118.214.247.61 的）可能不支持 HTTP/2，
			# 当这些客户端连接时，如果 Nginx 同时使用 HTTP/2 进行代理，可能会返回 403 Forbidden 错误。
			# 为了解决这个问题，可以通过将 proxy_http_version 设置为 1.1，
			# 强制代理请求使用 HTTP/1.1，从而确保协议协商正确：
			# proxy_http_version 1.1;
			proxy_http_version 1.1;
		}
	}
	#	RFI End

	#	Dailymotion Start
	server {
		listen 443 ssl;

		server_name graphql.api.dailymotion.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://34.84.14.157;
		}
	}

	server {
		listen 443 ssl;

		server_name geo.dailymotion.com;
		server_name geo.player.dailymotion.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://35.82.199.74;
		}
	}

	server {
		listen 443 ssl;

		server_name dmads.dailymotion.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://65.8.161.92;
		}
	}

	server {
		listen 443 ssl;

		server_name dailymotion.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://195.8.215.136;
		}
	}

	server {
		listen 443 ssl;

		server_name *.dailymotion.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://34.84.14.157;
		}
	}
	#	Dailymotion End

	#	Gravatar Start
	server {
		listen 443 ssl;

		server_name gravatar.com;
		server_name *.gravatar.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://192.0.80.240;
		}
	}
	#	Gravatar End

	#	Patreon Start
	server {
		listen 443 ssl;

		server_name patreon.com;
		server_name *.patreon.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://104.16.25.14;
		}
	}

	server {
		listen 443 ssl;

		server_name patreonusercontent.com;
		server_name *.patreonusercontent.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://104.18.70.106;
		}
	}
	#	Patreon End

	#	Flickr Start
	server {
		listen 443 ssl;

		server_name identity.flickr.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://3.209.240.130;
		}
	}

	server {
		listen 443 ssl;

		server_name flickr.com;
		server_name *.flickr.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://13.33.142.102;
		}
	}
	#	Flickr End

	#	Imgur Start
	server {
		listen 443 ssl;

		server_name imgur.com;
		server_name *.imgur.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://199.232.196.193;
		}
	}
	#	Imgur End

	#	TheTVDB Start
	server {
		listen 443 ssl;

		server_name thetvdb.com;
		server_name *.thetvdb.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://13.35.222.88;
		}
	}
	#	TheTVDB End

	#	Vercel Start
	server {
		listen 443 ssl;

		server_name vercel.app;
		server_name *.vercel.app;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_name vercel.com;

		location / { 
			proxy_pass https://64.29.17.193;
		}
	}
	#	Vercel End

	#	Docker Hub Start
	upstream hub-docker-com {
		server 54.163.142.90:443;
		server 52.4.38.75:443;
		server 44.195.222.37:443;
	}

	upstream prod-publishers-content-s3-us-east-1-amazonaws-com {
		server 52.217.230.98:443;
		server 52.216.94.126:443;
		server 52.217.202.106:443;
		server 16.15.178.85:443;
		server 16.15.197.190:443;
		server 16.15.187.205:443;
		server 16.15.194.179:443;
		server 16.182.67.82:443;
	}

	server {
		listen 443 ssl;

		server_name hub.docker.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://hub-docker-com;
		}
	}
	
	server {
		listen 443 ssl;

		server_name prod-publishers-content.s3.us-east-1.amazonaws.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_verify off;

		location / { 
			proxy_pass https://prod-publishers-content-s3-us-east-1-amazonaws-com;
		}
	}
	#	Docker Hub End

	#	WGCZ Holding Start
	upstream xvideos-com {
		server 185.88.181.2:443;
		server 185.88.181.3:443;
		server 185.88.181.4:443;
		server 185.88.181.5:443;
		server 185.88.181.6:443;
		server 185.88.181.7:443;
		server 185.88.181.8:443;
		server 185.88.181.9:443;
		server 185.88.181.10:443;
		server 185.88.181.11:443;
	}

	upstream xnxx-com {
		server 185.88.181.53:443;
		server 185.88.181.54:443;
		server 185.88.181.55:443;
		server 185.88.181.56:443;
		server 185.88.181.57:443;
		server 185.88.181.58:443;
		server 185.88.181.59:443;
		server 185.88.181.60:443;
	}

	server {
		listen 443 ssl;

		server_name xvideos.com;
		server_name *.xvideos.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_server_name off;
		proxy_ssl_verify off;

		location / {
			proxy_pass https://xvideos-com;
		}
	}


	server {
		listen 443 ssl;

		server_name xnxx.com;
		server_name *.xnxx.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		proxy_ssl_server_name off;
		proxy_ssl_verify off;

		location / {
			proxy_pass https://xnxx-com;
		}
	}
	#	WGCZ Holding End

	#	Discord Start
	upstream discord-com {
		server 162.159.128.233:443;
		server 162.159.136.232:443;
		server 162.159.135.232:443;
		server 162.159.138.232:443;
		server 162.159.137.232:443;
	}

	upstream discord-gg {
		server 162.159.136.234:443;
		server 162.159.134.234:443;
		server 162.159.130.234:443;
		server 162.159.135.234:443;
		server 162.159.133.234:443;
	}

	upstream discordapp-com {
		server 162.159.135.233:443;
		server 162.159.130.233:443;
		server 162.159.133.233:443;
		server 162.159.134.233:443;
		server 162.159.129.233:443;
	}

	upstream media-discordapp-net {
		server 162.159.129.232:443;
		server 162.159.134.232:443;
		server 162.159.130.232:443;
		server 162.159.128.232:443;
		server 162.159.133.232:443;
	}

    server {
		listen 443 ssl;

        server_name ~^(.*\.)?discord\.com$;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://discord-com;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header X-Forwarded-Proto $scheme;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection $connection_upgrade;
			proxy_http_version 1.1;
            proxy_read_timeout 86400s;
            proxy_send_timeout 86400s;
        }
    }

    server {
        listen 443 ssl;

        server_name ~^(.*\.)?discord\.gg$;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://discord-gg;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header X-Forwarded-Proto $scheme;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection $connection_upgrade;
			proxy_http_version 1.1;
            proxy_read_timeout 86400s;
            proxy_send_timeout 86400s;
        }
    }

    server {
        listen 443 ssl;

        server_name ~^(.*\.)?discordapp\.com$;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://discordapp-com;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header X-Forwarded-Proto $scheme;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection $connection_upgrade;
			proxy_http_version 1.1;
            proxy_read_timeout 86400s;
            proxy_send_timeout 86400s;
        }
    }

    server {
        listen 443 ssl;

        server_name ~^(.*\.)?discordapp\.net$;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://media-discordapp-net;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header X-Forwarded-Proto $scheme;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection $connection_upgrade;
			proxy_http_version 1.1;
            proxy_read_timeout 86400s;
            proxy_send_timeout 86400s;
        }
    }
	#	Discord End

	#	Tails Start
	upstream tails-net {
		server 94.142.244.34:443;
		server 204.13.164.63:443;
	}

    server {
        listen 443 ssl;

        server_name download.tails.net;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://204.13.164.63:443;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP "204.13.164.63";
			proxy_set_header X-Forwarded-For "204.13.164.63";
        }
    }

    server {
        listen 443 ssl;

        server_name ~^(.*\.)?tails\.net$;

        ssl_certificate ca/SNIBypassCrt.crt;
        ssl_certificate_key ca/SNIBypassKey.key;

        proxy_ssl_verify off;

        location / {
            proxy_pass https://tails-net;
			proxy_set_header Host $http_host;
			proxy_set_header X-Real-IP "204.13.164.63";
			proxy_set_header X-Forwarded-For "204.13.164.63";
        }
    }
	#	Tails End
	
	#	Quora Start
	upstream quora-com {
		server 34.197.23.66:443;
		server 3.216.97.102:443;
		server 98.83.166.53:443;
		server 54.89.119.95:443;
	}

	server {
		listen 443 ssl;
		
		server_name quora.com;
		server_name *.quora.com;
		server_name *.www.quora.com;
		server_name *.tch.quora.com;
		server_name *.www.tch.quora.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;

		location / {
			proxy_pass https://quora-com;
			proxy_ssl_name fs.quoracdn.net;
			# 亦可使用下面的 SNI：
			# proxy_ssl_name qr.ae;
		}
	}
	#	Quora End
	
	#	Audiomack Start
	upstream audiomack-com {
		server 3.167.200.113:443;
	}

	server {
		listen 443 ssl;
		
		server_name audiomack.com;
		server_name *.audiomack.com;
		server_name *.prod.us-east-1.aws.audiomack.com;

		ssl_certificate ca/SNIBypassCrt.crt;
		ssl_certificate_key ca/SNIBypassKey.key;
				
		proxy_ssl_server_name off;
		proxy_ssl_verify off;
				
		location / {
			proxy_pass https://audiomack-com;
		}
	}
	#	Audiomack End

	#	default_server Start
	server {
		listen 80 default_server;
		listen [::]:80 default_server;
		access_log off;
		return 301 https://$host$request_uri;
	}
	#	default_server End
}